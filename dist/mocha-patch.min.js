/**
* @license
* Copyright Google Inc. All Rights Reserved.
*
* Use of this source code is governed by an MIT-style license that can be
* found in the LICENSE file at https://angular.io/license
*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self)["mocha-patch-rollup"]=n()}(this,function(){"use strict";return function(e){var n=e.Mocha;if(void 0===n)throw new Error("Missing Mocha.js");if("undefined"==typeof Zone)throw new Error("Missing Zone.js");var t=Zone.ProxyZoneSpec,r=Zone.SyncTestZoneSpec;if(!t)throw new Error("Missing ProxyZoneSpec");if(n.__zone_patch__)throw new Error('"Mocha" has already been patched with "Zone".');n.__zone_patch__=!0;var o,i,u=Zone.current,f=u.fork(new r("Mocha.describe")),c=null,s=u.fork(new t),a={after:n.after,afterEach:n.afterEach,before:n.before,beforeEach:n.beforeEach,describe:n.describe,it:n.it};function p(e,n,t){for(var r=function(r){var o=e[r];"function"==typeof o&&(e[r]=0===o.length?n(o):t(o),e[r].toString=function(){return o.toString()})},o=0;o<e.length;o++)r(o);return e}function h(e){return p(e,function(e){return function(){return f.run(e,this,arguments)}})}function l(e){return p(e,function(e){return function(){return c.run(e,this)}},function(e){return function(n){return c.run(e,this,[n])}})}function d(e){return p(e,function(e){return function(){return s.run(e,this)}},function(e){return function(n){return s.run(e,this,[n])}})}e.describe=e.suite=n.describe=function(){return a.describe.apply(this,h(arguments))},e.xdescribe=e.suite.skip=n.describe.skip=function(){return a.describe.skip.apply(this,h(arguments))},e.describe.only=e.suite.only=n.describe.only=function(){return a.describe.only.apply(this,h(arguments))},e.it=e.specify=e.test=n.it=function(){return a.it.apply(this,l(arguments))},e.xit=e.xspecify=n.it.skip=function(){return a.it.skip.apply(this,l(arguments))},e.it.only=e.test.only=n.it.only=function(){return a.it.only.apply(this,l(arguments))},e.after=e.suiteTeardown=n.after=function(){return a.after.apply(this,d(arguments))},e.afterEach=e.teardown=n.afterEach=function(){return a.afterEach.apply(this,l(arguments))},e.before=e.suiteSetup=n.before=function(){return a.before.apply(this,d(arguments))},e.beforeEach=e.setup=n.beforeEach=function(){return a.beforeEach.apply(this,l(arguments))},o=n.Runner.prototype.runTest,i=n.Runner.prototype.run,n.Runner.prototype.runTest=function(e){var n=this;Zone.current.scheduleMicroTask("mocha.forceTask",function(){o.call(n,e)})},n.Runner.prototype.run=function(e){return this.on("test",function(e){c=u.fork(new t)}),this.on("fail",function(e,n){var t=c&&c.get("ProxyZoneSpec");if(t&&n)try{n.message+=t.getAndClearPendingTasksInfo()}catch(e){}}),i.call(this,e)}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}),{}});